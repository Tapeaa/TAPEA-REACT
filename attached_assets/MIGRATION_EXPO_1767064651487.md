# TĀPE'A - Guide Complet de Migration vers Expo/React Native

## INSTRUCTIONS POUR L'IA

Ce document contient TOUTES les spécifications techniques de l'application TĀPE'A, une application de VTC/taxi en français pour la Polynésie française (Tahiti). Utilisez ce document pour reconstruire l'application en Expo/React Native tout en conservant 100% de la logique métier.

**IMPORTANT**: Le backend Express reste INCHANGÉ. L'app Expo communiquera avec le backend déployé à l'URL suivante (à remplacer par l'URL réelle):
```
https://[votre-projet].replit.app
```

---

## 1. APERÇU DE L'APPLICATION

### Description
TĀPE'A est une application de VTC avec deux interfaces distinctes:
- **Interface CLIENT**: Pour commander et suivre des courses
- **Interface CHAUFFEUR**: Pour recevoir et effectuer des courses (accès via code 6 chiffres)

### Langue
L'interface est entièrement en **français**.

### Devise
Tous les prix sont en **XPF (Franc Pacifique)**.

### Format téléphone
Tous les numéros commencent par **+689** (Polynésie française).

---

## 2. ÉCRANS À RECRÉER

### Interface Client (16 écrans)

| Écran | Description |
|-------|-------------|
| `Accueil` | Carte Google Maps avec géolocalisation, catégories de navigation, bouton de commande |
| `CommandeOptions` | Sélection du type de course, adresses multiples, passagers, suppléments, paiement |
| `CommandeSuccess` | Animation de recherche de chauffeur avec countdown |
| `CourseEnCours` | Suivi GPS temps réel du chauffeur sur la carte |
| `CourseDetails` | Détails d'une course terminée + téléchargement facture PDF |
| `Commandes` | Historique des courses avec filtres |
| `Wallet` | Solde portefeuille + aperçu des cartes bancaires |
| `CartesBancaires` | Gestion des cartes (ajout via Stripe, suppression, carte par défaut) |
| `Profil` | Menu principal du profil |
| `InfoPerso` | Modification des informations personnelles |
| `Notifications` | Paramètres de notifications |
| `Confidentialite` | Politique de confidentialité |
| `Tarifs` | Grille tarifaire |
| `Aide` | Centre d'aide |
| `Support` | Chat de support |
| `Documents` | Documents légaux |
| `Contact` | Informations de contact |

### Interface Chauffeur (10 écrans)
Accès via code à 6 chiffres (ex: 111111)

| Écran | Description |
|-------|-------------|
| `ChauffeurLogin` | Saisie du code d'accès à 6 chiffres |
| `ChauffeurAccueil` | Carte + toggle EN LIGNE/HORS LIGNE + réception nouvelles courses |
| `ChauffeurCourseEnCours` | Navigation GPS vers client puis destination, boutons de statut |
| `ChauffeurCourses` | Historique des courses effectuées |
| `ChauffeurGains` | Dashboard des gains (jour/semaine/mois) |
| `ChauffeurProfil` | Profil et informations véhicule |
| `ChauffeurDocuments` | Documents légaux (permis, assurance, etc.) |
| `ChauffeurAide` | Centre d'aide |
| `ChauffeurSupport` | Chat de support |

### Écrans Authentification

| Écran | Description |
|-------|-------------|
| `auth/Login` | Connexion client (téléphone + mot de passe) |
| `auth/Register` | Inscription client |
| `auth/ForgotPassword` | Récupération mot de passe |
| `auth/ResetPassword` | Réinitialisation mot de passe |

---

## 3. MODÈLE DE DONNÉES (PostgreSQL)

### Table: clients
```sql
CREATE TABLE clients (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  phone TEXT NOT NULL UNIQUE,          -- Format: +689XXXXXX
  hashed_password TEXT NOT NULL,
  first_name TEXT NOT NULL,
  last_name TEXT NOT NULL,
  email TEXT,
  is_verified BOOLEAN DEFAULT false,
  wallet_balance REAL DEFAULT 0,       -- En XPF
  average_rating REAL,                 -- 1-5
  total_rides INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### Table: drivers
```sql
CREATE TABLE drivers (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  phone TEXT NOT NULL UNIQUE,
  code TEXT NOT NULL,                  -- Code 6 chiffres pour login
  first_name TEXT NOT NULL,
  last_name TEXT NOT NULL,
  vehicle_model TEXT,
  vehicle_color TEXT,
  vehicle_plate TEXT,
  is_active BOOLEAN DEFAULT true,
  average_rating REAL,
  total_rides INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### Table: orders
```sql
CREATE TABLE orders (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id VARCHAR REFERENCES clients(id),
  client_name TEXT NOT NULL,
  client_phone TEXT NOT NULL,
  addresses JSONB NOT NULL,            -- Array d'adresses
  ride_option JSONB NOT NULL,          -- Type de course
  route_info JSONB,                    -- Distance/durée
  passengers INTEGER NOT NULL,
  supplements JSONB NOT NULL,          -- Bagages, encombrants
  total_price REAL NOT NULL,           -- En XPF
  driver_earnings REAL NOT NULL,       -- 80% du total
  payment_method TEXT DEFAULT 'cash',  -- 'cash' ou 'card'
  scheduled_time TIMESTAMP,            -- Pour réservations
  is_advance_booking BOOLEAN DEFAULT false,
  status TEXT DEFAULT 'pending',
  assigned_driver_id VARCHAR,
  client_rating_id VARCHAR,
  driver_rating_id VARCHAR,
  created_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP NOT NULL
);
```

### Table: client_sessions
```sql
CREATE TABLE client_sessions (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id VARCHAR NOT NULL REFERENCES clients(id),
  expires_at TIMESTAMP NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  last_seen_at TIMESTAMP DEFAULT NOW()
);
```

### Table: driver_sessions
```sql
CREATE TABLE driver_sessions (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  driver_id VARCHAR NOT NULL REFERENCES drivers(id),
  driver_name TEXT NOT NULL,
  is_online BOOLEAN DEFAULT false,
  expires_at TIMESTAMP NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  last_seen_at TIMESTAMP DEFAULT NOW()
);
```

### Table: stripe_customers
```sql
CREATE TABLE stripe_customers (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id VARCHAR NOT NULL UNIQUE REFERENCES clients(id),
  stripe_customer_id TEXT NOT NULL UNIQUE,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### Table: payment_methods
```sql
CREATE TABLE payment_methods (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id VARCHAR NOT NULL REFERENCES clients(id),
  stripe_payment_method_id TEXT NOT NULL UNIQUE,
  last4 TEXT NOT NULL,
  brand TEXT NOT NULL,                 -- visa, mastercard, etc.
  expiry_month INTEGER NOT NULL,
  expiry_year INTEGER NOT NULL,
  is_default BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### Table: invoices
```sql
CREATE TABLE invoices (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  client_id VARCHAR NOT NULL REFERENCES clients(id),
  order_id VARCHAR NOT NULL REFERENCES orders(id),
  stripe_payment_intent_id TEXT,
  stripe_invoice_id TEXT,
  amount REAL NOT NULL,
  currency TEXT DEFAULT 'XPF',
  status TEXT DEFAULT 'pending',       -- pending, paid, failed
  pdf_url TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  paid_at TIMESTAMP
);
```

### Table: verification_codes
```sql
CREATE TABLE verification_codes (
  id VARCHAR PRIMARY KEY DEFAULT gen_random_uuid(),
  phone TEXT NOT NULL,
  code TEXT NOT NULL,
  type TEXT NOT NULL,                  -- registration, login, password_reset
  expires_at TIMESTAMP NOT NULL,
  used_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);
```

---

## 4. STATUTS DE COMMANDE

### Statuts stockés en base de données
```typescript
type OrderStatus = 
  | "pending"           // En attente de chauffeur
  | "accepted"          // Chauffeur accepté
  | "declined"          // Refusé
  | "expired"           // Expiré (5 min)
  | "cancelled"         // Annulé
  | "driver_enroute"    // Chauffeur en route
  | "driver_arrived"    // Chauffeur arrivé
  | "in_progress"       // Course en cours
  | "completed"         // Course terminée
  | "payment_pending"   // Attente paiement
  | "payment_confirmed" // Paiement confirmé
  | "payment_failed"    // Paiement échoué
```

### Mapping WebSocket → Base de données
Quand le chauffeur envoie un `ride:status:update`, le backend convertit:
| WebSocket status | DB status |
|------------------|-----------|
| `enroute` | `driver_enroute` |
| `arrived` | `driver_arrived` |
| `inprogress` | `in_progress` |
| `completed` | `completed` |

---

## 5. API ENDPOINTS (REST)

### Authentification Client

```
POST /api/auth/register
Body: { phone: "+689XXXXXX", password: "...", firstName: "...", lastName: "..." }
Response: { client, session }

POST /api/auth/login
Body: { phone: "+689XXXXXX", password: "..." }
Response: { client, session }

POST /api/auth/logout
Headers: Cookie: clientSessionId=...
Response: { success: true }

GET /api/auth/me
Headers: Cookie: clientSessionId=...
Response: { client } ou { error }

POST /api/auth/forgot-password
Body: { phone: "+689XXXXXX" }
Response: { message: "Code envoyé" }

POST /api/auth/reset-password
Body: { phone: "+689XXXXXX", code: "123456", newPassword: "..." }
Response: { success: true }

POST /api/auth/resend-code
Body: { phone: "+689XXXXXX", type: "registration" }
Response: { message }

POST /api/auth/verify
Body: { phone: "+689XXXXXX", code: "123456" }
Response: { client, session } ou { error }
```

### Push Notifications (Chauffeurs)

```
GET /api/push/vapid-public-key
Response: { publicKey: "..." }

POST /api/push/subscribe
Body: { sessionId: "...", subscription: { endpoint, keys: { p256dh, auth } } }
Response: { success: true }

DELETE /api/push/subscribe/:sessionId
Response: { success: true }

GET /api/push/status/:sessionId
Response: { subscribed: true/false }
```

### Authentification Chauffeur

```
POST /api/driver/login
Body: { code: "111111" }
Response: { driver, session }

POST /api/driver-sessions
Body: { driverId: "...", driverName: "..." }
Response: { session }

PATCH /api/driver-sessions/:id/status
Body: { isOnline: true/false }
Response: { session }

GET /api/driver-sessions/:id
Response: { session }
```

### Commandes

```
POST /api/orders
Headers: Cookie: clientSessionId=...
Body: {
  clientName: "...",
  clientPhone: "+689XXXXXX",
  addresses: [{ id, value, placeId, type, lat, lng }],
  rideOption: { id, title, price, pricePerKm },
  routeInfo: { distance: 5.2, duration: "15 min" },
  passengers: 2,
  supplements: [{ id, name, icon, price, quantity }],
  paymentMethod: "cash" | "card",
  totalPrice: 3500,
  driverEarnings: 2800,
  scheduledTime: null,
  isAdvanceBooking: false
}
Response: { order, clientToken: "..." }

GET /api/orders/pending
Response: [orders]

GET /api/orders/active/client
Headers: Cookie: clientSessionId=...
Response: { order, clientToken }

GET /api/orders/active/driver?sessionId=...
Response: { order }

GET /api/orders/:id
Response: { order }

GET /api/orders/:id/driver-location
Response: { lat, lng, heading, speed, timestamp }
```

### Profil Client

```
GET /api/client/orders
Headers: Cookie: clientSessionId=...
Response: [orders]

PATCH /api/client/profile
Headers: Cookie: clientSessionId=...
Body: { firstName?, lastName?, email? }
Response: { client }

GET /api/client/wallet
Headers: Cookie: clientSessionId=...
Response: { balance, transactions }
```

### Profil Chauffeur

```
GET /api/driver/profile/:driverId
Response: { driver }

PATCH /api/driver/profile/:driverId
Body: { firstName?, lastName?, vehicleModel?, vehicleColor?, vehiclePlate? }
Response: { driver }

GET /api/driver/orders/:sessionId
Response: [orders]
```

### Stripe Paiement

```
GET /api/stripe/publishable-key
Response: { publishableKey: "pk_..." }

POST /api/stripe/customer
Headers: Cookie: clientSessionId=...
Response: { stripeCustomerId: "cus_..." }

POST /api/stripe/setup-intent
Headers: Cookie: clientSessionId=...
Response: { clientSecret: "seti_..." }

POST /api/stripe/payment-method
Headers: Cookie: clientSessionId=...
Body: { paymentMethodId: "pm_..." }
Response: { paymentMethod }

GET /api/stripe/payment-methods/:clientId
Headers: Cookie: clientSessionId=...
Response: [paymentMethods]

DELETE /api/stripe/payment-method/:id
Headers: Cookie: clientSessionId=...
Response: { success: true }

POST /api/stripe/payment-method/:id/default
Headers: Cookie: clientSessionId=...
Response: { paymentMethod }

POST /api/stripe/payment-intent
Headers: Cookie: clientSessionId=...
Body: { orderId: "...", paymentMethodId: "pm_..." }
Response: { clientSecret, paymentIntentId, status, invoice }

POST /api/stripe/confirm-payment
Headers: Cookie: clientSessionId=...
Body: { paymentIntentId: "pi_...", orderId: "..." }
Response: { success, invoice }

GET /api/stripe/invoices/:clientId
Headers: Cookie: clientSessionId=...
Response: [invoices]

POST /api/stripe/generate-invoice/:orderId
Headers: Cookie: clientSessionId=...
Response: { pdfUrl: "..." }

GET /api/stripe/invoice/order/:orderId
Headers: Cookie: clientSessionId=...
Response: { invoice }
```

---

## 6. ÉVÉNEMENTS WEBSOCKET (Socket.IO)

### Configuration connexion
```javascript
import { io } from "socket.io-client";

const socket = io("https://[votre-backend].replit.app", {
  transports: ["websocket", "polling"],
  reconnection: true,
  reconnectionAttempts: 10,
  reconnectionDelay: 1000,
});
```

### Événements CLIENT → Serveur

```javascript
// Rejoindre une course
socket.emit("client:join", { orderId: "...", clientToken: "..." });

// Confirmer paiement (espèces)
socket.emit("payment:confirm", { 
  orderId: "...", 
  confirmed: true, 
  role: "client", 
  clientToken: "..." 
});

// Retenter paiement carte
socket.emit("payment:retry", { orderId: "...", clientToken: "..." });

// Changer en espèces
socket.emit("payment:switch-cash", { orderId: "...", clientToken: "..." });

// Annuler course
socket.emit("ride:cancel", { 
  orderId: "...", 
  role: "client", 
  reason: "...", 
  clientToken: "..." 
});

// Mettre à jour position client
socket.emit("location:client:update", { 
  orderId: "...", 
  lat: -17.5334, 
  lng: -149.5667, 
  clientToken: "..." 
});

// Rejoindre room de course
socket.emit("ride:join", { 
  orderId: "...", 
  role: "client", 
  clientToken: "..." 
});
```

### Événements CHAUFFEUR → Serveur

```javascript
// Rejoindre en tant que chauffeur
socket.emit("driver:join", { sessionId: "..." });

// Changer statut en ligne
socket.emit("driver:status", { sessionId: "...", isOnline: true });

// Accepter commande
socket.emit("order:accept", { orderId: "...", sessionId: "..." });

// Refuser commande
socket.emit("order:decline", { orderId: "...", sessionId: "..." });

// Mettre à jour statut course
// IMPORTANT: Les valeurs de statut sont: "enroute", "arrived", "inprogress", "completed"
socket.emit("ride:status:update", { 
  orderId: "...", 
  status: "arrived", // "enroute" | "arrived" | "inprogress" | "completed"
  sessionId: "..." 
});

// Confirmer paiement reçu
socket.emit("payment:confirm", { 
  orderId: "...", 
  confirmed: true, 
  role: "driver", 
  sessionId: "..." 
});

// Annuler course
socket.emit("ride:cancel", { 
  orderId: "...", 
  role: "driver", 
  reason: "...", 
  sessionId: "..." 
});

// Mettre à jour position GPS
socket.emit("location:driver:update", { 
  orderId: "...", 
  lat: -17.5334, 
  lng: -149.5667, 
  heading: 45,
  speed: 30,
  sessionId: "..." 
});

// Rejoindre room de course
socket.emit("ride:join", { 
  orderId: "...", 
  role: "driver", 
  sessionId: "..." 
});
```

### Événements Serveur → Tous

```javascript
// Nouvelle commande (chauffeurs en ligne)
socket.on("order:new", (order) => { ... });

// Liste des commandes en attente (reçu après driver:join si en ligne)
socket.on("orders:pending", (orders) => { ... });

// Commande prise par un autre chauffeur
socket.on("order:taken", ({ orderId }) => { ... });

// Commande expirée
socket.on("order:expired", ({ orderId }) => { ... });

// Chauffeur assigné
socket.on("order:driver:assigned", ({ orderId, driver }) => { ... });

// Acceptation réussie
socket.on("order:accept:success", (order) => { ... });

// Erreur acceptation
socket.on("order:accept:error", ({ message }) => { ... });

// Statut course changé
socket.on("ride:status:changed", ({ orderId, status }) => { ... });

// Course annulée
socket.on("ride:cancelled", ({ orderId, cancelledBy, reason }) => { ... });

// Statut paiement
socket.on("payment:status", ({ 
  orderId, 
  status,          // "pending", "confirmed", "failed"
  paymentMethod,   // "cash" ou "card"
  error?           // Message d'erreur
}) => { ... });

// Paiement prêt à retenter
socket.on("payment:retry:ready", ({ orderId }) => { ... });

// Passage en espèces
socket.on("payment:switched-to-cash", ({ orderId }) => { ... });

// Position GPS du chauffeur
socket.on("location:driver", ({ 
  orderId, 
  lat, 
  lng, 
  heading,
  speed,
  timestamp 
}) => { ... });

// Erreurs
socket.on("client:join:error", ({ message }) => { ... });
socket.on("ride:status:error", ({ message }) => { ... });
socket.on("payment:error", ({ message }) => { ... });
socket.on("ride:cancel:error", ({ message }) => { ... });
```

---

## 7. TARIFICATION

### Options de course

```typescript
const rideOptions = [
  {
    id: "immediate",
    title: "Taxi immédiat",
    duration: "10 - 20 min",
    capacity: "1 - 8 passagers",
    basePrice: 2300,      // XPF
    pricePerKm: 150,      // XPF/km
  },
  {
    id: "reservation",
    title: "Réservation à l'avance",
    duration: "45 - 1h",
    capacity: "1 - 8 passagers",
    basePrice: 2300,
    pricePerKm: 150,
  },
  {
    id: "tour",
    title: "Tour de l'Île",
    duration: "45 - 1h",
    capacity: "4 - 8 passagers",
    basePrice: 30000,     // Prix fixe
    pricePerKm: 0,
  },
];
```

### Suppléments

```typescript
const supplements = [
  { id: "bagages", name: "Bagages", icon: "bagages", price: 100 },      // par unité
  { id: "encombrants", name: "Encombrants", icon: "encombrants", price: 200 },
];
```

### Calcul du prix

```typescript
function calculatePrice(
  rideOption: RideOption,
  distanceKm: number,
  supplements: Supplement[]
): { totalPrice: number; driverEarnings: number } {
  const basePrice = rideOption.basePrice;
  const distancePrice = distanceKm * rideOption.pricePerKm;
  const supplementsTotal = supplements.reduce(
    (sum, s) => sum + s.price * s.quantity, 
    0
  );
  
  const totalPrice = basePrice + distancePrice + supplementsTotal;
  const driverEarnings = Math.round(totalPrice * 0.80); // 80% pour le chauffeur
  
  return { totalPrice, driverEarnings };
}
```

---

## 8. AUTHENTIFICATION

### Client
- Inscription: téléphone (+689) + mot de passe + prénom + nom
- Connexion: téléphone + mot de passe
- Session stockée côté serveur (cookie `clientSessionId`)
- Durée session: 30 jours
- Pour React Native: utiliser `SecureStore` pour stocker le sessionId

### Chauffeur
- Connexion avec code 6 chiffres uniquement
- Session via `sessionId` retourné
- Toggle EN LIGNE/HORS LIGNE pour recevoir des courses

### Implémentation React Native

```typescript
import * as SecureStore from 'expo-secure-store';

// Sauvegarder session client
await SecureStore.setItemAsync('clientSessionId', session.id);

// Récupérer session
const sessionId = await SecureStore.getItemAsync('clientSessionId');

// Pour les requêtes API, ajouter le header
fetch(url, {
  headers: {
    'Cookie': `clientSessionId=${sessionId}`,
    'Content-Type': 'application/json',
  },
});
```

---

## 9. DÉPENDANCES EXPO RECOMMANDÉES

```json
{
  "expo": "~51.0.0",
  "expo-location": "~17.0.0",
  "expo-notifications": "~0.28.0",
  "expo-secure-store": "~13.0.0",
  "expo-router": "~3.5.0",
  "react-native-maps": "1.14.0",
  "@stripe/stripe-react-native": "0.37.0",
  "socket.io-client": "^4.7.0",
  "@tanstack/react-query": "^5.0.0",
  "zustand": "^4.5.0",
  "date-fns": "^3.0.0",
  "nativewind": "^4.0.0",
  "tailwindcss": "^3.4.0"
}
```

---

## 10. STRUCTURE DE FICHIERS SUGGÉRÉE

```
/app                          # Expo Router pages
  /(auth)
    login.tsx
    register.tsx
    forgot-password.tsx
  /(client)
    index.tsx                 # Accueil
    commande-options.tsx
    commande-success.tsx
    course-en-cours.tsx
    course-details/[id].tsx
    commandes.tsx
    wallet.tsx
    cartes-bancaires.tsx
    profil.tsx
    info-perso.tsx
    tarifs.tsx
    aide.tsx
    support.tsx
  /(chauffeur)
    login.tsx
    index.tsx                 # ChauffeurAccueil
    course-en-cours.tsx
    courses.tsx
    gains.tsx
    profil.tsx
    documents.tsx
    aide.tsx
    support.tsx
  _layout.tsx

/components
  /ui                         # Composants réutilisables
    Button.tsx
    Card.tsx
    Input.tsx
    ...
  /maps
    MapView.tsx
    DriverMarker.tsx
    RoutePolyline.tsx
  /payment
    CardForm.tsx
    PaymentModal.tsx

/hooks
  useAuth.ts
  useSocket.ts
  useLocation.ts

/lib
  api.ts                      # Fetch wrapper
  socket.ts                   # Configuration Socket.IO
  queryClient.ts

/stores
  authStore.ts                # Zustand store
  orderStore.ts

/types
  index.ts                    # Types TypeScript
```

---

## 11. FONCTIONNALITÉS CRITIQUES

### 1. Modal de paiement sur l'accueil
Quand une course a le statut `payment_pending` ou `payment_failed`, afficher automatiquement un modal de paiement sur la page d'accueil du client pour qu'il puisse finaliser ou retenter le paiement.

### 2. Suivi GPS temps réel
- Client: voir la position du chauffeur mise à jour toutes les 2-3 secondes
- Chauffeur: envoyer sa position en continu pendant la course

### 3. Polling HTTP de fallback
Si WebSocket échoue, utiliser `GET /api/orders/:id/driver-location` toutes les 3 secondes.

### 4. Facture PDF téléchargeable
Après paiement par carte, le client peut télécharger la facture PDF depuis l'historique.

### 5. Expiration des commandes
Les commandes en `pending` expirent après 5 minutes si aucun chauffeur n'accepte.

---

## 12. DESIGN & UI

### Couleurs principales
- **Primaire**: Jaune doré (#F5A623 ou similaire)
- **Fond**: Blanc/Gris très clair
- **Texte**: Noir/Gris foncé
- **Succès**: Vert (#22C55E)
- **Erreur**: Rouge (#EF4444)
- **En ligne**: Vert
- **Hors ligne**: Gris

### Éléments UI
- Header avec menu hamburger (drawer)
- Bottom sheets pour les options
- Cards arrondies
- Boutons arrondis
- Switch pour toggle en ligne/hors ligne
- Badges pour statuts

### Mobile-first
- Safe areas pour iPhone (notch, home indicator)
- Gestures pour fermer les modals
- Pull-to-refresh sur les listes

---

## 13. VARIABLES D'ENVIRONNEMENT REQUISES

```env
# Backend URL
EXPO_PUBLIC_API_URL=https://[votre-projet].replit.app

# Google Maps
EXPO_PUBLIC_GOOGLE_MAPS_API_KEY=...

# Stripe
EXPO_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_...
```

---

## 14. NOTES IMPORTANTES

1. **Sessions**: Utiliser `SecureStore` au lieu des cookies
2. **Stripe**: Utiliser `@stripe/stripe-react-native` (différent du web)
3. **Maps**: Utiliser `react-native-maps` avec `PROVIDER_GOOGLE`
4. **WebSocket**: Socket.IO fonctionne identiquement en React Native
5. **Background location**: Implémenter pour les chauffeurs (suivi en arrière-plan)
6. **Permissions**: Demander GPS et notifications au bon moment

---

Ce document contient tout ce qu'il faut pour reconstruire TĀPE'A en Expo/React Native!
